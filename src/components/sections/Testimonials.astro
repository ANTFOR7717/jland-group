---
// Testimonials Component - Two Column Layout
// Refactored to use UI components and Tailwind CSS only

import { Card, Container, CardGrid, ContentBlock } from "../ui/index.js";
import { Layout, SectionHeader, Spacer } from "../ui/index.js";
import { Section } from "../ui/index.js";
import { ProjectGallery, FeaturedTestimonial } from "../ui/index.js";
// Note: Heading requires direct import due to TypeScript compatibility
import Heading from "../ui/display/Heading.astro";

export interface Props {
  images?: any[];
  testimonial?: any;
  heading?: string;
  featured_testimonial?: {
    quote: string;
    customerName: string;
    location: string;
    rating: number;
    avatarUrl?: string;
  };
  highlight_heading?: string;
  highlight_rating?: number;
  highlight_total?: number;
  reviews?: {
    name: string;
    location: string;
    rating: number;
    service?: string;
    time?: string;
    text?: string;
  }[];
}

const {
  images,
  testimonial,
  heading,
  featured_testimonial,
  highlight_heading,
  highlight_rating,
  highlight_total,
  reviews,
} = Astro.props;
---

<Section
  background="dark"
  padding="sm"
  style="padding: 0; padding-top: 2rem; padding-bottom: 2rem;"
>
  <Layout
    variant="two-column"
    leftBackground="dark"
    rightBackground="light"
    minHeight="654px"
    leftPadding="md"
    rightPadding="sm"
    gap="md"
  >
    <!-- Left Column Content -->
    <div slot="left">
      <ContentBlock spacing="md" class="w-full max-w-none sm:max-w-[592px]">
        <Heading
          level={2}
          size="2xl"
          color="white"
          class="text-xl sm:text-2xl md:text-3xl leading-7 sm:leading-8 md:leading-9"
        >
          {heading}
        </Heading>

        <!-- Featured Testimonial -->
        <FeaturedTestimonial
          quote={featured_testimonial.quote}
          customerName={featured_testimonial.customerName}
          location={featured_testimonial.location}
          avatarUrl={featured_testimonial.avatarUrl}
          rating={featured_testimonial.rating}
          variant="default"
        />

        <!-- Recent Projects Section -->
        <Spacer size="md" direction="top">
          <div class="text-center">
            <Heading
              level={3}
              size="md"
              color="white"
              class="text-sm sm:text-base md:text-lg leading-5 sm:leading-6 md:leading-7 mb-3 sm:mb-4"
            >
              Recent Projects
            </Heading>
          </div>

          <ProjectGallery
            images={images}
            variant="horizontal"
            imageSize="lg"
            gap="sm"
          />
        </Spacer>
      </ContentBlock>
    </div>

    <!-- Right Column Content -->
    <div slot="right">
      <!-- Customer Reviews Header -->
      <Section background="transparent" padding="sm">
        <Container size="md" class="flex justify-center">
          <SectionHeader
            title={highlight_heading}
            level={2}
            size="xl"
            showRating={true}
            rating={highlight_rating}
            totalReviews={highlight_total}
            layout="horizontal"
            alignment="left"
            spacing="sm"
          />
        </Container>
      </Section>

      <!-- Reviews List -->
      <CardGrid variant="testimonial" columns={1} gap="md" maxWidth="max-w-2xl">
        {
          reviews.map((review) => (
            <Card
              variant="review"
              customerName={review.name}
              location={review.location}
              rating={review.rating}
              serviceType={review.service}
              timeAgo={review.time}
              reviewText={review.text}
            />
          ))
        }
      </CardGrid>
    </div>
  </Layout>
</Section>
