---
// Contact Section Component - Pixel-perfect implementation from Motiff design
// Refactored to use reusable UI components
import Section from '../ui/layout/Section.astro';
import Container from '../ui/layout/Container.astro';
import Heading from '../ui/display/Heading.astro';
import Text from '../ui/display/Text.astro';
import Input from '../ui/forms/Input.astro';
import Form from '../ui/forms/Form.astro';
import Button from '../ui/buttons/Button.astro';
import Card from '../ui/display/Card.astro';
import Icon from '../ui/display/Icon.astro';
import ContentBlock from '../ui/display/ContentBlock.astro';
---

<Section background="light" padding="none" class="flex flex-col items-stretch pb-8 sm:pb-12">
  <!-- Header Section -->
  <Section background="dark" padding="none" class="flex gap-3 flex-col items-stretch">
    <Container size="md" class="text-center mt-6 sm:mt-8 mb-8 sm:mb-14">
      <Heading level={2} color="white" class="text-ellipsis min-h-8 sm:min-h-10 max-w-[601px] mx-auto text-xl sm:text-2xl md:text-3xl">
        Let's Discuss Your Project
      </Heading>
      <Text variant="lead" color="muted" class="text-ellipsis min-h-6 sm:min-h-7 max-w-[456px] mx-auto mt-2 sm:mt-3 text-sm sm:text-base">
        Our experts are ready to help with your exterior needs
      </Text>
    </Container>
  </Section>

  <!-- Google Maps Section with Location Card -->
  <Section background="transparent" padding="none" class="relative w-full h-[400px]">
    <Container size="full" class="w-full flex flex-col items-stretch relative">
      <!-- Google Maps Iframe -->
      <div class="w-full h-[400px] mt-1">
        <iframe 
          src="https://maps.google.com/maps?width=100%25&amp;height=400&amp;hl=en&amp;q=3636%20Glenoble%20Ct,%20Jefferson,%20MD%2021755&amp;t=&amp;z=14&amp;ie=UTF8&amp;iwloc=&amp;output=embed"
          width="100%" 
          height="400" 
          style="border:0;" 
          allowfullscreen="" 
          loading="lazy" 
          referrerpolicy="no-referrer-when-downgrade"
          class="w-full h-full"
          title="J Land Contracting Location - 3636 Glenoble Court, Jefferson, MD 21755">
        </iframe>
        
        <!-- Location Card Overlay
        <div class="absolute top-8 right-8 z-10 px-8">
          <Card class="w-80 gap-2 flex-col items-stretch bg-white shadow-lg">
            <Container size="full" class="w-[280px] flex items-start min-h-7">
              <Heading level={3} size="lg" class="w-28 items-center flex text-ellipsis min-h-7">
                 Our Location
               </Heading>
            </Container>
            <Container size="full" class="gap-3 flex flex-row items-stretch pr-[13.36px]">
              <Icon name="location" size="sm" class="p-2" />
              <Text color="secondary" class="leading-6 items-center flex text-ellipsis min-h-[72px]">
                3636 Glenoble Court, Jefferson, MD 21755
              </Text>
            </Container>
          </Card>
        </div> -->
      </div>
    </Container>
  </Section>

  <!-- Form Section -->
  <Container size="sm" class="text-center mt-6 sm:mt-8">
    <Heading level={3} size="xl" class="text-ellipsis min-h-6 sm:min-h-8 max-w-[228px] mx-auto text-lg sm:text-xl md:text-2xl">
       Send Us a Message
     </Heading>
  </Container>

  <!-- Contact Form -->
  <Container size="md" class="px-4 sm:px-6 md:px-8">
    <Form variant="default" class="space-y-4 sm:space-y-6">
      <ContentBlock class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6" maxWidth="w-full" spacing="sm">
        <ContentBlock maxWidth="w-full" spacing="sm">
          <Text variant="small" weight="medium" color="default" class="block mb-2">
            Your Name
          </Text>
          <Input type="text" name="name" placeholder="John Smith" class="w-full" />
        </ContentBlock>
        <ContentBlock maxWidth="w-full" spacing="sm">
          <Text variant="small" weight="medium" color="default" class="block mb-2">
            Email Address
          </Text>
          <Input type="email" name="email" placeholder="john@example.com" class="w-full" />
        </ContentBlock>
      </ContentBlock>

      <ContentBlock class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6" maxWidth="w-full" spacing="sm">
        <ContentBlock maxWidth="w-full" spacing="sm">
          <Text variant="small" weight="medium" color="default" class="block mb-2">
            Phone Number
          </Text>
          <Input type="tel" name="phone" placeholder="(123) 456-7890" class="w-full" />
        </ContentBlock>
        <ContentBlock maxWidth="w-full" spacing="sm">
          <Text variant="small" weight="medium" color="default" class="block mb-2">
            Project Address
          </Text>
          <Input type="text" name="address" placeholder="Enter your project address..." class="w-full" />
        </ContentBlock>
      </ContentBlock>

      <ContentBlock maxWidth="w-full" spacing="sm">
        <Text variant="small" weight="medium" color="default" class="block mb-2">
          Message
        </Text>
        <Input type="textarea" name="message" placeholder="Tell us about your exterior project..." rows={6} class="w-full" ></Input>
      </ContentBlock>

      <!-- Submit Button -->
      <ContentBlock class="flex justify-center mt-6 sm:mt-8" maxWidth="w-full" spacing="sm">
        <Button variant="primary" size="lg" type="submit" class="w-full sm:w-auto">
          Submit Request
        </Button>
      </ContentBlock>
    </Form>
  </Container>

  <!-- Contact Icons and Info -->
  <Section background="transparent" padding="none" class="flex justify-center items-center gap-6 sm:gap-8 md:gap-12 lg:gap-16 mt-4 sm:mt-6 px-4">
    <Button href="tel:+14102920801" variant="link" class="flex flex-col items-center no-underline hover:opacity-90 !text-inherit !font-normal !p-0 !rounded-none">
      <ContentBlock class="bg-gray-50 border border-[#C1B9BC] rounded-full p-2 sm:p-3 md:p-4 flex w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 justify-center items-center mb-1 sm:mb-2 md:mb-3" maxWidth="w-12" spacing="sm">
        <Icon name="phone-contact" size="sm" />
      </ContentBlock>
      <Text weight="medium" class="text-center mb-1 text-xs sm:text-sm md:text-base">
        Call Us
      </Text>
      <Text color="secondary" class="text-center text-xs">
        (410) 292-0801
      </Text>
    </Button>
    <Button href="mailto:info@jlandgroup.com" variant="link" class="flex flex-col items-center no-underline hover:opacity-90 !text-inherit !font-normal !p-0 !rounded-none">
      <ContentBlock class="bg-gray-50 border border-[#C1B9BC] rounded-full p-2 sm:p-3 md:p-4 flex w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 justify-center items-center mb-1 sm:mb-2 md:mb-3" maxWidth="w-12" spacing="sm">
        <Icon name="email-contact" size="sm" />
      </ContentBlock>
      <Text weight="medium" class="text-center mb-1 text-xs sm:text-sm md:text-base">
        Email Us
      </Text>
      <Text color="secondary" class="text-center text-xs">
        info@jlandgroup.com
      </Text>
    </Button>
  </Section>
</Section>

<!-- Google Places API Script -->
<script src={`https://maps.googleapis.com/maps/api/js?key=${import.meta.env.GOOGLE_MAPS_API_KEY}&libraries=places`}></script>

<script>
  // Simple Google Places address validation
  document.addEventListener('DOMContentLoaded', function() {
    const addressInput = document.querySelector('input[name="address"]') as HTMLInputElement;
    
    if (addressInput && (window as any).google) {
      const google = (window as any).google;
      const autocomplete = new google.maps.places.Autocomplete(addressInput, {
        types: ['address'],
        componentRestrictions: { country: 'us' }
      });
      
      autocomplete.addListener('place_changed', function() {
        const place = autocomplete.getPlace();
        if (place.formatted_address) {
          addressInput.value = place.formatted_address;
        }
      });
    }
  });
</script>